$(document).ready(function(){"use strict";function a(){$(".tambah-btn").attr("data-content","Pendaftaran anggota Baru?"),$(".colvis-btn").attr("data-content","Tampilkan / sembunyikan cell tabel"),$(".refresh-btn").attr("data-content","Refresh tabel"),$(".search-btn").attr("data-content","Tampilkan / sembunyikan kolom pencarian"),$(".clear-search-btn").attr("data-content","Bersihkan field pencarian"),$(".copy-btn").attr("data-content","Salin data tabel"),$(".print-btn").attr("data-content","Cetak tabel"),$(".csv-btn").attr("data-content","Simpan ke CSV"),$(".excel-btn").attr("data-content","Simpan ke Excel"),$(".reset-colorder-btn").attr("data-content","Kembalikan posisi kolom head tabel"),$(".ui.button").popup()}function t(a,t){var e=noty({modal:!0,text:"<h4>Peringatan</h4>Data Pasien merupakan parent dari data Rawat Jalan.<br>Apabila menghapus data ini, server akan otomatis menghapus semua data Rawat Jalan pasien ini.<br>Anda yakin menghapus data ini?",buttons:[{addClass:"ui negative small button",text:'<i class="icon close"></i>Tidak',onClick:function(a,t){e.close()}},{addClass:"ui positive small button",text:'<i class="icon check"></i>Iya',onClick:function(i,o){var r=$(this);r.addClass("loading disabled"),$.post(a,{id:t,_token:$("#data-pasien").attr("data-token")},function(a){if(a.response){noty({text:a.message,timeout:5e3,layout:"topRight",type:"success"});n.ajax.reload(),e.close()}else{noty({text:a.message,timeout:5e3,layout:"topRight",type:"warning"})}}).fail(function(a){var t=$.parseJSON(a.responseText);if(t.message){noty({text:t.message,layout:"topRight",type:"error"});return!1}noty({text:a.statusText,layout:"topRight",type:"error"})}).done(function(){r.removeClass("loading disabled")})}}]})}$("#data-pasien thead th").addClass("center aligned");var e=!0,n=$("#data-pasien").DataTable({ajax:{url:$("#data-pasien").data("source")},language:{url:$("#data-pasien").data("lang")},lengthMenu:[[10,25,100,200,500,-1],[10,25,100,200,500,"Semua"]],searchDelay:1e3,stateSave:!0,scrollY:"60vh",scrollCollapse:!0,scrollX:!0,dom:"<'left no padding-bottom floated aligned sixteen wide mobile eight wide computer column'l><'right no padding-bottom aligned sixteen wide mobile eight wide computer column'f><'ui button-container sixteen wide tablet ten wide toolbar-container column'><'sixteen wide column no padding top bottom'tr><'sixteen wide mobile four wide computer column'i><'right aligned sixteen wide mobile twelve wide computer column'p>",processing:!0,pagingType:"numbers",serverSide:!0,filter:!0,sort:!0,info:!0,order:[[2,"asc"]],columns:[{data:null,visible:!0,sortable:!1,render:function(a,t,e){return'<div class="ui checkbox-table checkbox"><input type="checkbox"> <label></label></div>'}},{data:"id",name:"id",className:"collapsing text-center"},{data:"nama",name:"nama"},{data:"kepala_keluarga",name:"kepala_keluarga"},{data:"no_kartu_keluarga",name:"no_kartu_keluarga"},{data:"jenis_kelamin",name:"jenis_kelamin"},{data:"action",name:"action",searchable:!1,sortable:!1,className:"actived text-center collapsing"}]});n.on("init.dt",function(){$(".dataTables_filter").addClass("ui datatables-search input"),yadcf.init(n,[{column_number:1,filter_type:"text",filter_reset_button_text:!1},{column_number:2,filter_type:"text",filter_reset_button_text:!1},{column_number:3,filter_type:"text",filter_reset_button_text:!1},{column_number:4,filter_type:"text",filter_reset_button_text:!1},{column_number:5,filter_type:"select",filter_reset_button_text:!1,data:[{value:"Laki-Laki",label:"Laki-Laki"},{value:"Perempuan",label:"Perempuan"}]}]),$(".yadcf-filter-wrapper").addClass("ui datatables-search input").css({display:"flex"}),$("#yadcf-filter-wrapper--data-pasien-0 input").css("width","50px"),$("#yadcf-filter-wrapper--data-pasien-1 input").css("width","90px"),$("#yadcf-filter-wrapper--data-pasien-2 input").css("width","80px"),$("#yadcf-filter-wrapper--data-pasien-3 input").css("width","100px"),$("#yadcf-filter-wrapper--data-pasien-4 select").css({margin:"0 auto"}),$(".yadcf-filter-wrapper button").html('<i class="close icon"></i>'),$(".yadcf-filter-wrapper button").addClass("ui small icon button"),$("[id^=yadcf]").hide(),$("#yadcf-filter-wrapper--data-pasien-0 input").keydown(function(a){$(this).focusin()}),new $.fn.dataTable.Buttons(n,{dom:{container:{tag:"div",className:"ui left floated group buttons"},collection:{tag:"div",className:"dt-button-collection"},button:{tag:"a",className:"ui tiny icon button",active:"active",disabled:"disabled"},buttonLiner:{tag:"",className:""}},buttons:[{text:'<i class="plus icon"></i>Tambah',className:"positive labeled icon tambah-btn",action:function(a,t,e,i){$('#pendaftaran-baru form [name="id"]').val(""),$("#pendaftaran-baru form").form("clear"),$('#pendaftaran-baru form input[type="hidden"][name="_token"]').val($("#pendaftaran-baru form").attr("data-token")),$("#pendaftaran-baru .header").text("Tambah Data Pasien"),$("#pendaftaran-baru").modal({closable:!1,onApprove:function(){return o("#pendaftaran-baru form",!0,function(){$("#rawat-jalan-field").hide(),n.ajax.reload()}),!1},onHidden:function(){$("#rawat-jalan-field").hide()}}).modal("show")}},{text:'<i class="trash icon"></i>Hapus',className:"negative labeled icon hapus-btn",action:function(a,e,n,i){var o=e.rows($("#data-pasien input:checked").parents("tr")).data();if(o.length<=0)return!1;var r=new Array;$.each(o,function(a,t){r.push(t.id)}),t($("#data-pasien").attr("data-delete"),r)}}]}),new $.fn.dataTable.Buttons(n,{dom:{container:{tag:"div",className:"ui basic right floated buttons"},collection:{tag:"div",className:"dt-button-collection"},button:{tag:"a",className:"ui toggle tiny icon button",active:"active",disabled:"disabled"},buttonLiner:{tag:"span",className:""}},buttons:[{text:'<i class="icon refresh"></i>Refresh',className:"refresh-btn",action:function(a,t,e,i){n.ajax.reload()}},{text:'<i class="icon check"></i>Check',className:"check-btn",action:function(a,t,e,n){$("#data-pasien .checkbox-table").checkbox("check")}},{text:'<i class="icon close"></i>Un-Check',className:"check-btn",action:function(a,t,e,n){$("#data-pasien .checkbox-table").checkbox("uncheck")}},{text:'<i class="clockwise search icon"></i>Cari',className:"search-btn",action:function(a,t,e){$(e).toggleClass("active").removeClass("toggle"),$(e).hasClass("active")?$("[id^=yadcf]").show():$("[id^=yadcf]").hide(),n.columns.adjust()}},{text:'<i class="undo icon"></i>Clear',className:"clear-search-btn",action:function(a,t,e){yadcf.exResetAllFilters(n),n.columns.adjust()}}]}),n.buttons(0,1).container().prependTo($(".toolbar-container")),$("#data-pasien").on("click",".delete-btn",function(a){a.preventDefault();var e=n.row($(this).parents("tr")).data();return e?void t($("#data-pasien").attr("data-delete"),[$(this).attr("data-id")]):!1}),$("#data-pasien").on("click",".edit-btn",function(a){a.preventDefault();var t=n.row($(this).parents("tr")).data();return t?($("#ubah-data .header").text("Ubah Data Pasien - ID: "+t.id),$("#ubah-data form").form("clear"),$('#ubah-data form input[type="hidden"][name="_token"]').val($("#ubah-data form").attr("data-token")),$.each(t,function(a,t){$('#ubah-data form [name="'+a+'"]').val(t)}),$("#ubah-data form .dropdown").dropdown(),void $("#ubah-data").modal({closable:!1,onApprove:function(){return o("#ubah-data form",!1,function(){n.ajax.reload()}),!1}}).modal("show")):!1}),$("#data-pasien").on("click",".view-btn",function(a){var t=n.row($(this).parents("tr")).data();return t?($.each(t,function(a,t){$('#view-data table td[data-list="'+a+'"]').text(t)}),void $("#view-data").modal({closable:!1}).modal("show")):!1}),$("#data-pasien").on("click",".daftarkan-btn",function(a){var t=n.row($(this).parents("tr")).data();return t?void $("#daftar-rawat-jalan").modal({onShow:function(){$('#daftar-rawat-jalan form [name="_token"]').val($("#daftar-rawat-jalan form").attr("data-token")),$('#daftar-rawat-jalan form [name="pasien_id"]').val(t.id),$('#daftar-rawat-jalan form [name="nama"]').val(t.nama),$("#daftar-rawat-jalan form .ui.dropdown").dropdown("restore defaults")},onApprove:function(){return o("#form-rawat-jalan",!0,function(){$("#daftar-rawat-jalan").modal("hide")}),!1}}).modal("show"):!1}),$("#daftar-rawat-jalan form").submit(function(a){a.preventDefault(),o("#daftar-rawat-jalan form",!1)}),$("#daftar-rawat-jalan form .negative.button, #daftar-rawat-jalan .close.link").click(function(a){$("#daftar-rawat-jalan").modal("hide")}),$(".dataTables_scrollBody").scroll(function(a){}),$("[id^=yadcf]").hide(),n.columns.adjust(),a()});var i=!0;$(window).resize(function(){if(i){i=!1;var a=setTimeout(function(){n.columns.adjust(),i=!0,clearTimeout(a)},1e3)}}),$('[name="tgl_lahir"]').inputmask("dd-mm-yyyy"),$(".ui.button").popup(),$("#jenis_kunjungan_dropdown").dropdown(),$("#jenis_kelamin_dropdown").dropdown(),$("#agama_dropdown").dropdown(),$("#kepesertaan-dropdown").dropdown({onChange:function(a,t,e){0==a?$('[name="_jenis_kepesertaan"]').parent().fadeIn():($('[name="_jenis_kepesertaan"]').parent().fadeOut(),$('[name="_jenis_kepesertaan"]').val(""))}}),$("#form-pendaftaran").form({on:"submit",keyboardShortcuts:!1,inline:!0,fields:{nama:["minLength[3]","maxLength[50]","empty"],kepala_keluarga:["minLength[3]","maxLength[50]","empty"],no_kartu_keluarga:["minLength[6]","maxLength[50]","empty","number"],jenis_kelamin:["empty"],alamat:"empty",pekerjaan:["minLength[3]","maxLength[50]","empty"],tgl_lahir:["empty","regExp[/[0-9]{2}-[0-9]{2}-[0-9]{4}/]"],agama:["empty","agama"],jenis_kepesertaan:"emptyif[daftar_rawat_jalan:checked]"}}),$("#form-pendaftaran input").on("keydown",function(a){var t=a.which;return 13===t?!1:void 0}),$("#form-pendaftaran").on("change","#daftar_rawat_jalan",function(a){$("#rawat-jalan-field .ui.dropdown").dropdown("restore defaults"),$(this).is(":checked")?$("#rawat-jalan-field").show():$("#rawat-jalan-field").hide()}),$("#form-ubah").form({on:"submit",keyboardShortcuts:!1,inline:!0,fields:{nama:["minLength[3]","maxLength[50]","empty"],kepala_keluarga:["minLength[3]","maxLength[50]","empty"],no_kartu_keluarga:["minLength[6]","maxLength[50]","empty","number"],jenis_kelamin:["empty"],alamat:"empty",pekerjaan:["minLength[3]","maxLength[50]","empty"],tgl_lahir:["empty","regExp[/[0-9]{2}-[0-9]{2}-[0-9]{4}/]"],agama:["empty","agama"]}}),$("#form-rawat-jalan").form({on:"submit",keyboardShortcuts:!1,inline:!0,fields:{jenis_kepesertaan:"empty"}});var o=function(a,t,n){return $(a).unbind("submit"),$(a).submit(function(i){if($(a).hasClass("loading")||!$(a).form("is valid")||!e)return!1;e=!1;var o=$(a).attr("action"),r=$(a).serialize(),s=$(a);noty({text:"Simpan data?",buttons:[{addClass:"ui positive small button",text:'<i class="icon save"></i>Simpan',onClick:function(a,i){s.addClass("loading"),$(this).addClass("disabled"),$(this).parent().find(".negative").addClass("disabled");var l=$(this),d=$(this).parent().find(".negative");a.setText('<i class="icon asterisk loading"></i>Mohon tunggu sebentar'),$.ajax({url:o,type:"POST",dataType:"json",data:r,success:function(e){if(e&&e.response){noty({layout:"topRight",text:e.message,type:"success"});t&&(s.form("clear"),s.find('[name="_token"]').val(s.attr("data-token"))),n&&n(),a.close()}else if(e&&!e.response){a.close();noty({layout:"topRight",text:e.message,type:"warning"})}},error:function(t){if(422==t.status){a.close();var e=$.parseJSON(t.responseText),n="<b>Form Validasi: </b>";n+='<ul style="text-align: left;">',$.each(e,function(a,t){Array.isArray(t)?$.each(t,function(a,t){n+="<li>"+t+"</li>"}):n+="<li>"+t+"</li>"}),n+="</ul>";noty({layout:"topRight",text:n,type:"warning"});return!1}a.setText("Simpan data?");noty({layout:"topRight",text:"Error: "+t.status+" "+t.statusText+"<br>Coba refresh browser kembali, apabila pesan ini masih muncul silahkan hubungi Administrator",type:"error"})},complete:function(){s.removeClass("loading"),l.removeClass("disabled"),d.removeClass("disabled"),e=!0}})}},{addClass:"ui negative small button",text:"Cancel",onClick:function(a){a.close(),e=!0}}],modal:!0,layout:"center"});i.preventDefault()}),$(a).submit()}});