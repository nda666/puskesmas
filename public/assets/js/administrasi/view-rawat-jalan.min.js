$(document).ready(function(){"use strict";function a(a){noty({modal:!0,text:"Hapus konsultasi yang anda pilih?",buttons:[{addClass:"ui positive small button",text:'<i class="icon check"></i>Iya',onClick:function(t,e){var n=$(this),s=$(this).parent().find(".negative");n.addClass("loading disabled"),s.addClass("disabled"),$.get($("#data-konsultasi").attr("data-hapus"),{id:a},function(a){if(a&&a.response){i.ajax.reload();noty({text:a.message,layout:"topRight",timeout:5e3,type:"success"});t.close()}else{noty({text:a.message,layout:"topRight",timeout:5e3,type:"warning"})}}).error(function(a){noty({text:a.status+" "+a.statusText,layout:"topRight",timeout:5e3,type:"warning"})}).always(function(){n.removeClass("disabled loading"),s.removeClass("disabled")})}},{addClass:"ui negative small button",text:'<i class="icon close"></i>Tidak',onClick:function(a,t){a.close()}}]})}$("#data-konsultasi thead th").addClass("center aligned");var t="#modal-konsultasi-insert form",e="#modal-konsultasi-insert";$("#selesai-rawat-jalan").click(function(a){a.preventDefault();var t=$("#selesai-rawat-jalan"),e='Tandai "Selesai" untuk rawat jalan ini?';"0"==$(this).attr("data-progres")&&(e='Tandai "Belum Selesai" untuk rawat jalan ini?');noty({modal:!0,text:e,buttons:[{addClass:"ui negative small button",text:'<i class="icon close"></i>Tidak',onClick:function(a,t){a.close(),1==$("#selesai-rawat-jalan").attr("data-progres")&&$("#selesai-rawat-jalan").attr("data-force","false")}},{addClass:"ui positive small button",text:'<i class="icon check"></i>Iya',onClick:function(a,n){var i=$(this),s=t.attr("data-force"),o=t.attr("data-progres");a.setText('<i class="icon loading asterisk"></i>Mohon Tunggu sebentar...'),$(this).hasClass("disabled")||($(this).addClass("disabled loading"),$.post($("#selesai-rawat-jalan").attr("data-action"),{id:t.attr("data-id"),force:s,progres:o,_token:t.attr("data-token")}).done(function(e){if(e.response){a.close();noty({layout:"topRight",type:"success",timeout:1e4,text:e.message});1==e.result?(t.attr("data-force","true").attr("data-progres","0").html('<i class="close icon"></i>Batalkan Selesai').removeClass("green").addClass("red"),$("#status-rawat-jalan").removeClass("red").addClass("green").text("Sudah")):(t.attr("data-force","false").attr("data-progres","1").html('<i class="check icon"></i>Selesai Rawat Jalan').removeClass("red").addClass("green"),$("#status-rawat-jalan").removeClass("green").addClass("red").text("Belum")),i.removeClass("disabled loading"),e.redirect&&(window.location.href=e.redirect)}else if(e.reconfirm)var n=setTimeout(function(){a.setText(e.message),t.attr("data-force","true"),i.removeClass("disabled loading"),clearTimeout(n)},1e3);else{noty({layout:"topRight",text:e.message,timeout:1e4})}}).fail(function(t){noty({layout:"topRight",text:"Error: "+t.status+" "+t.statusText});a.setText(e),i.removeClass("disabled loading")}))}}]})}),$("#tab-rawat-jalan a.item").tab({history:!0,onLoad:function(a){$(window).trigger("resize"),"data-tindakan"==a&&$(window).trigger("look")}}),$("#kasus-dropdown").dropdown(),$("#pegawai-dropdown").dropdown({apiSettings:{url:"/administrasi/rawat-jalan/petugas?find={query}&role=konsultan",saveRemoteData:!1},saveRemoteData:!1}),$("#poli-dropdown").dropdown({apiSettings:{url:$("#poli-dropdown").attr("data-source")+"?find={query}",saveRemoteData:!1},saveRemoteData:!1});var n="#data-konsultasi",i=$("#data-konsultasi").DataTable({ajax:{url:$("#data-konsultasi").data("source")},language:{url:$("#data-konsultasi").data("lang")},lengthMenu:[[10,25,100,200,500,-1],[10,25,100,200,500,"Semua"]],searchDelay:1e3,stateSave:!1,scrollY:"60vh",scrollCollapse:!0,scrollX:!0,dom:"<'left no padding-bottom floated aligned sixteen wide mobile eight wide computer column'l><'right no padding-bottom aligned sixteen wide mobile eight wide computer column'f><'ui button-container sixteen wide tablet ten wide toolbar-container column'><'sixteen wide column no padding top bottom'tr><'sixteen wide mobile four wide computer column'i><'right aligned sixteen wide mobile twelve wide computer column'p>",processing:!0,pagingType:"numbers",serverSide:!0,filter:!0,sort:!0,info:!0,order:[[1,"asc"]],columns:[{data:null,visible:!0,sortable:!1,searchable:!1,width:"7px",className:"text-center",render:function(a,t,e){return'<div style="margin-left: 7px;" class="ui checkbox-table checkbox"><input type="checkbox"> <label></label></div>'}},{data:"id",name:"ruang_konsul.id"},{data:"pemeriksaan_fisik",name:"pemeriksaan_fisik",render:function(a){return a=a.length>=50?a.substr(0,50)+"...":a}},{data:"diagnosa",name:"diagnosa",render:function(a){return a=a.length>=50?a.substr(0,50)+"...":a}},{data:"kasus",name:"kasus"},{data:"nama_poli",name:"poli.nama"},{data:"keterangan",name:"keterangan",render:function(a){return a=a.length>=50?a.substr(0,50)+" ...":a}},{data:"action",name:"action",sortable:!1,searchable:!1}],drawCallback:function(){s()}});i.on("init.dt",function(){yadcf.init(i,[{column_number:1,filter_type:"text",filter_reset_button_text:!1},{column_number:2,filter_type:"text",filter_reset_button_text:!1},{column_number:3,filter_type:"text",filter_reset_button_text:!1},{column_number:4,filter_type:"select",filter_reset_button_text:!1,data:[{value:"Baru",label:"Baru"},{value:"Lama",label:"Lama"}]},{column_number:5,filter_type:"text",filter_reset_button_text:!1},{column_number:6,filter_type:"text",filter_reset_button_text:!1}]),$(".dataTables_filter").addClass("ui datatables-search input"),$(".yadcf-filter-wrapper").addClass("ui datatables-search input").css({display:"flex"}),$("#yadcf-filter-wrapper--data-konsultasi-1 input").css("width","50px"),$("#yadcf-filter-wrapper--data-konsultasi-2 input").css("width","90px"),$("#yadcf-filter-wrapper--data-konsultasi-3 input").css("width","80px"),$("#yadcf-filter-wrapper--data-konsultasi-4 input").css("width","100px"),$("#yadcf-filter-wrapper--data-konsultasi-5 input").css("width","70px"),$("#yadcf-filter-wrapper--data-konsultasi-6 input").css("width","100px"),$(".yadcf-filter-wrapper button").html('<i class="close icon"></i>'),$(".yadcf-filter-wrapper button").addClass("ui small icon button"),$("[id^=yadcf]").hide(),new $.fn.dataTable.Buttons(i,{dom:{container:{tag:"div",className:"ui group buttons"},collection:{tag:"div",className:"dt-button-collection"},button:{tag:"a",className:"ui tiny labeled icon button",active:"active",disabled:"disabled"},buttonLiner:{tag:"",className:""}},buttons:[{text:'<i class="plus icon"></i>Tambah',className:"primary icon tambah-btn",titleAttr:"Tambah Data Konsultasi",action:function(a,n,s,o){$(t).form("clear"),$(t+' input[type="hidden"][name="_token"]').val($(t).attr("data-token")),$(t+' [name="rawat_jalan_id"]').val($(t).attr("data-id")),$(e+" .header").text("Tambah Data Konsultasi"),$(e).modal({closable:!1,onApprove:function(){return form_submit(t,!1,function(){$(t).form("clear"),$(t+' input[type="hidden"][name="_token"]').val($(t).attr("data-token")),$(t+' [name="rawat_jalan_id"]').val($(t).attr("data-id")),i.ajax.reload()}),!1}}).modal("show")}},{text:'<i class="trash icon"></i>Hapus',className:"negative hapus-btn",titleAttr:"Hapus Data Yang di Checklist",action:function(t,e,n,i){var s=e.rows($("#data-konsultasi input:checked").parents("tr")).data();if(s.length<=0)return!1;var o=new Array;$.each(s,function(a,t){o.push(t.id)}),a(o)}}]}),new $.fn.dataTable.Buttons(i,{dom:{container:{tag:"div",className:"ui basic right floated buttons"},collection:{tag:"div",className:"dt-button-collection"},button:{tag:"a",className:"ui toggle tiny icon button",active:"active",disabled:"disabled"},buttonLiner:{tag:"span",className:""}},buttons:[{text:'<i class="icon refresh"></i>Refresh',className:"refresh-btn",action:function(a,t,e,n){i.ajax.reload()}},{text:'<i class="icon check"></i>Check',className:"check-btn",action:function(a,t,e,n){$("#data-konsultasi .checkbox-table").checkbox("check")}},{text:'<i class="icon close"></i>Un-Check',className:"check-btn",action:function(a,t,e,n){$("#data-konsultasi .checkbox-table").checkbox("uncheck")}},{text:'<i class="search icon"></i>Cari',className:"search-btn",action:function(a,t,e){$(e).toggleClass("active").removeClass("toggle"),$(e).hasClass("active")?$("[id^=yadcf]").show():$("[id^=yadcf]").hide(),i.columns.adjust()}},{text:'<i class="undo icon"></i>Clear',className:"clear-search-btn",action:function(a,t,e){yadcf.exResetAllFilters(i),i.columns.adjust()}}]}),$(n).on("click",".view-btn",function(a){a.preventDefault();var t=i.row($(this).parents("tr")).data(),e="#modal-konsultasi-view";return t?($.each(t,function(a,t){$(e+' [data-name="'+a+'"]').text(t)}),$(e+" td").css("text-align","justify"),void $(e).modal("show")):!1}),$(n).on("click",".edit-btn",function(a){a.preventDefault(),i.ajax.reload();var t=i.row($(this).parents("tr")).data(),e="#modal-konsultasi-insert form",n="#modal-konsultasi-insert";return t?($("#ubah-data form .ui.dropdown").dropdown(),$(n+" .content").css({height:$(window).height()-200+"px","overflow-x":"auto"}),$(n+" .header").text("Ubah Data Konsultasi - ID: "+t.id),$(e).form("clear"),$.each(t,function(a,t){$(e+' [name="'+a+'"]').val(t)}),$(e+' [name="poli_id"]').parent(".ui.dropdown").dropdown("set text",t.nama_poli),$(e+' [name="kasus"]').parent(".ui.dropdown").dropdown(),$(e+' input[type="hidden"][name="_token"]').val($(e).attr("data-token")),void $(n).modal({closable:!1,onApprove:function(){return form_submit("#modal-konsultasi-insert form",!1,function(){i.ajax.reload()}),!1}}).modal("show")):!1}),$(n).on("click",".delete-btn",function(t){t.preventDefault(),i.ajax.reload();var e=i.row($(this).parents("tr")).data(),n=[e.id];return e?void a(n):!1}),i.buttons(0,1).container().prependTo($(".toolbar-container")),i.columns.adjust()});var s=function(){$(".ui.button").popup()};$(".ui.button, a").popup(),$("#jenis_kunjungan_dropdown").dropdown(),$("#jenis_kelamin_dropdown").dropdown(),$("#agama_dropdown").dropdown(),$("#kepesertaan-dropdown").dropdown({onChange:function(a,t,e){0==a?$('[name="_jenis_kepesertaan"]').parent().fadeIn():($('[name="_jenis_kepesertaan"]').parent().fadeOut(),$('[name="_jenis_kepesertaan"]').val(""))}}),$(t).form({inline:!0,on:"submit",fields:{pemeriksaan_fisik:["empty"],diagnosa:["empty"],tindakan:["empty"],poli_id:["empty"],kasus:["empty"]}})});